## 高性能 IO 模型：为什么单线程Redis能那么快？

redis 的单线程只要是只 redis 的网络 IO 和键值对读写是由一个线程来完成的，这也是 redis 对外提供键值存储服务的主要流程。但是 redis 的其他功能，比如持久化、一步删除、集群数据同步等，是由额外的线程来执行的。

所以严格来说 redis 不是单线程。

### 为什么用单线程？为什么单线程能这么快？

我们来看下一下 redis 单线程设计机制以及多路复用机制

### redis 为什么使用单线程？

更好对了姐 redis 为什么用单线程，我们要了解多线程的开销

#### 多线程的开销

日常写程序时，使用多线程有一下优点“使用多线程，可以增加系统吞吐率，看也增加系统拓展性”，在合理的资源分配情况下，增加系统中处理请求操作的资源你尸体，进而提升系统能够处理的请求书，即吞吐率。

<img src="https://user-images.githubusercontent.com/19903677/113002322-3bddfc80-91a4-11eb-90e4-2562b78a96c4.png" alt="ab9a384d70578236800ceaa8e58ff45c" style="zoom:25%;" />



但是如果灭有良好的系统设计，实际得到的结果，其实是右图所展示的那样。我们开始增加线程数时，视同吞吐率会增加，但是在进一步增加线程时，系统吞吐率就增长迟缓了，甚至还会出现下降的情况？

为什么出现这种情况呢？一个关键的瓶颈在于。系统中通常会存在被多线程同时访问的共享资源，比如一个共享的数据结构，当有多个线程修改这个资源时，为了保证共享资源的正确性，就需要有额外的机制进行保证，那么就会带来额外的开销。

拿 redis 来说，redis 的 List 数据类型，提供出队（LPOP) 和入队（Lpush）操作，如果使用多线程 A 和 B 一个入队，并且长度+1，一个出队，并且长度-1
